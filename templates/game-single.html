{% extends "base.html" %}

{% load static %}

{% block contenido %}


	<!-- Page top section -->
	<section class="page-top-section set-bg" data-setbg="{% if game.image %}{% static 'img/games/' %}{{ game.image }}{% else %}{% static 'img/page-top-bg/1.jpg' %}{% endif %}">
		<div class="page-info">
			<h2>{% if game.title %}{{ game.title }}{% else %}Juego{% endif %}</h2>
			<div class="site-breadcrumb">
				<a href="{% url 'main' %}">Inicio</a> /
				<span>{% if game.title %}{{ game.title }}{% else %}Juegos{% endif %}</span>
			</div>
		</div>
	</section>
	<!-- Page top end-->


	<!-- Juegos section -->
	<section class="games-single-page">
		<div class="container">
			<div class="game-single-preview">
				{% if game.image %}
				<img alt="{{ game.title }}" style="width:100%;height:420px;object-fit:cover;" src="{% static 'img/games/' %}{{ game.image }}">
				{% else %}
				<img src="{% static 'img/games/no-image.svg' %}" alt="{{ game.title }}">
				{% endif %}
			</div>
			<div class="row">
				<div class="col-xl-9 col-lg-8 col-md-7 game-single-content">
					<div class="gs-meta">{% if game.created_at %}{{ game.created_at|date:"d.m.Y" }}{% else %}--/--/----{% endif %} / in <a href="#">Juegos</a></div>
					<h2 class="gs-title">{% if game.title %}{{ game.title }}{% else %}Juego{% endif %}</h2>
					<div class="game-meta-options" style="margin-bottom:10px; color: white;">
						<span style="display:inline-block;margin-right:12px;"><strong>Plataforma:</strong> {% if game.platform %}{{ game.platform }}{% else %}N/A{% endif %}</span>
						<span style="display:inline-block;"><strong>Género:</strong> {% if game.genre %}{{ game.genre }}{% else %}N/A{% endif %}</span>
					</div>
					<h4 style="margin-top: 50px;" >Gameplay</h4>
					<p>{% if game.description %}{{ game.description }}{% else %}N/A{% endif %}</p>

					<!-- Reviews for this game -->
					<div class="mt-5">
						<h4>Tus Reseñas</h4>
						{% if reviews %}
						{% for r in reviews %}
						<div class="review-item" style="background:transparent;padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.05);">
							<div class="row">
								<div class="col-lg-2">
									<div class="review-pic">
										<img src="{% if r.image %}{% static r.image %}{% else %}{% static 'img/games/no-image.svg' %}{% endif %}" alt="" style="width:100%;height:60px;object-fit:cover;">
									</div>
								</div>
								<div class="col-lg-10">
									<div class="review-content text-white">
										<div class="rating"><span>{{ r.rating }}</span> / 5</div>
										<h5>{{ r.title }}</h5>
										<p>{{ r.content|truncatechars:200 }}</p>
										<div class="top-meta">{{ r.created_at|date:"d.m.Y" }} / por <strong>{{ r.author_name|default:"Anónimo" }}</strong></div>
									</div>
								</div>
							</div>
						</div>
						{% endfor %}
						{% else %}
						<p>No hay reseñas aún. <a href="{% url 'review_add' %}">Agrega la primera reseña</a>.</p>
						{% endif %}
					</div>
				</div>
				<div class="col-xl-3 col-lg-4 col-md-5 sidebar game-page-sideber">
					<div id="stickySidebar">
						<a href="{% url 'review_add' %}" class="btn btn-primary" style="margin:10px 0; display:block;">Agregar reseña</a>
						<div class="widget-item">
							<div class="rating-widget">
								<h4 class="widget-title">Ratings</h4>
								<ul>
									<li>Price<span>{% if game.price_rating %}{{ game.price_rating }} / 5{% else %}N/A{% endif %}</span></li>
									<li>Graphics<span>{% if game.graphics_rating %}{{ game.graphics_rating }} / 5{% else %}N/A{% endif %}</span></li>
									<li>Levels<span>{% if game.levels_rating %}{{ game.levels_rating }} / 5{% else %}N/A{% endif %}</span></li>
									<li>Dificulty<span>{% if game.difficulty_rating %}{{ game.difficulty_rating }} / 5{% else %}N/A{% endif %}</span></li>
								</ul>
								<div class="rating">
									<h5><i>Rating</i><span>{% if average_rating %}{{ average_rating }}{% elif game.rating %}{{ game.rating }}{% else %}N/A{% endif %}</span>{% if average_rating or game.rating %} / 5{% endif %}</h5>
								</div>
							</div>
						</div>
						<div class="widget-item">
							<div class="testimonials-widget">
								<h4 class="widget-title">Última reseña</h4>
								{% if reviews %}
								<div class="testim-text">
									<p>{{ reviews.0.content|truncatechars:120 }}</p>
									<h6><span>{{ reviews.0.author_name|default:"Anónimo" }},</span> Usuario</h6>
								</div>
								{% else %}
								<p>No hay comentarios aún.</p>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>


{% endblock %}